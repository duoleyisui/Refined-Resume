var $systemSummaryPanel = (function() {
    var $systemSummaryDOM = $(''
      +'<div id="system-summary-panel">'
      +'<div id="manager-count">'
      +'<div><svg t="1529395801752" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3197" xmlns:xlink="http://www.w3.org/1999/xlink" width="48" height="48"><defs><style type="text/css"></style></defs><path d="M512 526.920559C627.36556 526.920559 720.887824 388.636618 720.887824 273.271058 720.887824 157.905498 627.36556 64.383234 512 64.383234 396.63444 64.383234 303.112176 157.905498 303.112176 273.271058 303.112176 388.636618 396.63444 526.920559 512 526.920559Z" p-id="3198" fill="#ffffff"></path><path d="M138.986028 795.697556C138.986028 739.255073 179.926628 673.072662 230.432504 647.873462L323.330409 601.523353 393.697527 844.251261C393.697527 844.251261 395.665621 865.254552 430.842897 865.254552 466.020174 865.254552 466.020174 844.251261 466.020174 844.251261L466.020174 646.28503C466.020174 646.28503 467.616473 601.523353 513.483522 601.523353 559.350571 601.523353 559.350571 646.28503 559.350571 646.28503L559.350571 844.251261C559.350571 844.251261 571.342968 869.13051 599.758437 869.13051 628.173908 869.13051 631.602637 844.251261 631.602637 844.251261L700.49616 601.523353 793.549033 647.907144C844.063725 673.087053 885.013972 739.246607 885.013972 795.697556L885.013972 857.418612C885.013972 913.861094 839.259943 959.616766 782.821851 959.616766L241.178149 959.616766C184.738999 959.616766 138.986028 913.86956 138.986028 857.418612L138.986028 795.697556Z" p-id="3199" fill="#ffffff"></path></svg></div>'
      +'<div>'
      +'<h1>2</h1>'
      +'<span>管理员总数</span>'
      +'</div>'
      +'</div>'
      +'<div id="user-count">'
      +'<div><svg t="1529395431262" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1899" xmlns:xlink="http://www.w3.org/1999/xlink" width="48" height="48"><defs><style type="text/css"></style></defs><path d="M1021.942 523.141v254.935h-58.181c-8.884-23.739-19.151-43.545-31.385-59.42-44.637-58.764-121.824-74.493-189.617-88.765-27.088-5.534-52.793-10.923-73.109-18.35-8.738-3.131-14.854-6.262-19.078-8.519 21.408-23.447 39.831-52.138 53.302-84.542 16.894-39.685 25.705-82.866 25.705-124.956 0-64.298-4.078-137.917-33.497-196.972-13.035-25.777-33.714-54.613-66.556-75.366 15.655-56.507 51.483-94.081 127.504-94.081 119.494 0 137.844 96.702 137.844 213.283 0 61.094-27.234 123.717-67.502 159.325-4.005 3.641-6.262 8.811-6.262 14.053-0.146 14.491 0.291 33.497 5.825 40.633 33.788 45.074 125.611 46.458 195.006 68.74M89.147 720.477c43.472-61.968 122.916-77.77 192.894-91.969 27.453-5.389 53.157-10.777 73.619-17.914 8.447-2.986 14.418-5.68 18.569-8.083-21.408-23.447-39.175-51.846-52.939-83.667-16.675-39.468-25.777-81.847-26.361-123.062-0.655-54.541 2.767-96.047 9.83-131.291 10.34-50.682 29.273-89.275 58.036-118.329 9.539-9.903 20.243-18.205 31.603-25.341-16.020-56.798-51.118-94.372-125.611-94.372-123.135 0-140.465 97.794-139.3 215.249 0.655 59.856 27.817 122.188 67.648 157.65 4.078 3.568 6.335 8.811 6.335 14.346 0 14.491-0.946 33.35-6.044 40.050-32.987 45.002-125.538 46.021-195.37 67.574v256.464h58.327c8.156-22.719 17.84-41.506 28.763-57.308M933.687 974.757c0.582 12.379-9.321 22.719-21.554 22.719h-799.393c-12.379 0-22.137-10.413-21.482-22.719 2.839-48.933 13.18-163.549 50.098-216.341 56.069-79.808 241.172-52.356 293.019-123.717 5.899-7.792 6.845-28.836 6.845-45.074 0-6.116-2.548-11.942-7.063-16.165-44.492-39.759-74.493-109.373-75.148-176.729-1.311-131.801 17.914-241.245 154.519-241.245 132.455 0 152.626 108.281 152.626 239.353 0 68.594-30.146 138.645-74.638 178.622-4.297 3.932-7.063 9.977-7.136 15.655-0.364 16.165 0.655 37.647 6.262 45.657 52.501 71.361 232.070 45.803 291.563 123.717 38.812 51.628 48.861 167.263 51.483 216.269z" p-id="1900" fill="#ffffff"></path></svg></div>'
      +'<div>'
      +'<h1>2</h1>'
      +'<span>注册用户数</span>'
      +'</div>'
      +'</div>'
      +'<div id="use-count">'
      +'<div><svg t="1529395888780" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3916" xmlns:xlink="http://www.w3.org/1999/xlink" width="48" height="48"><defs><style type="text/css"></style></defs><path d="M968.111109 537.411763 968.111109 537.411763c-18.367323 0-33.257451 14.890128-33.257451 33.257451l0 308.840974c0 13.673417-11.084453 24.756847-24.756847 24.756847L112.937189 904.267035c-13.672394 0-24.756847-11.083429-24.756847-24.756847L88.180342 143.988392c0-13.672394 11.084453-24.756847 24.756847-24.756847l395.822001 0c18.367323 0 33.257451-14.890128 33.257451-33.257451l0 0c0-18.367323-14.890128-33.257451-33.257451-33.257451L112.937189 52.716642c-50.408063 0-91.27175 40.863686-91.27175 91.27175l0 735.521796c0 50.408063 40.863686 91.27175 91.27175 91.27175l797.159622 0c50.408063 0 91.27175-40.863686 91.27175-91.27175L1001.36856 570.669214C1001.36856 552.301891 986.479455 537.411763 968.111109 537.411763z" p-id="3917" fill="#ffffff"></path><path d="M872.91191 302.297954c5.804193 5.729491 1.746784 15.614629-6.408967 15.614629L403.556149 317.912583c-50.408063 0-91.27175 40.863686-91.27175 91.27175l0 298.096259 66.514903 0L378.799302 409.184333c0-13.672394 11.084453-24.756847 24.756847-24.756847l566.202483 0c29.733185 0 44.524053-36.036751 23.364127-56.925501L857.155041 193.277982c-13.071713-12.903891-34.128285-12.767791-47.032176 0.303922l0 0c-12.903891 13.071713-12.767791 34.128285 0.303922 47.032176L872.91191 302.297954z" p-id="3918" fill="#ffffff"></path></svg></div>'
      +'<div>'
      +'<h1>2</h1>'
      +'<span>使用次数</span>'
      +'</div>'
      +'</div>'
      +'<div id="template-count">'
      +'<div><svg t="1529395938569" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4678" xmlns:xlink="http://www.w3.org/1999/xlink" width="48" height="48"><defs><style type="text/css"></style></defs><path d="M480.007761 32.014816v959.992945H32.014816V32.014816h447.992945M512.011289 0.011289H0.022577V1024h511.988712V0.011289zM991.996472 31.992239v416.011994h-415.989417V31.992239h415.989417M1024 0H544.003528v480.007761h479.996472V0zM991.996472 544.014816v447.992945h-415.989417V544.014816h415.989417m32.003528-32.003527H544.003528V1024h479.996472V512.011289z" p-id="4679" fill="#ffffff"></path></svg></div>'
      +'<div>'
      +'<h1>2</h1>'
      +'<span>模板数量</span>'
      +'</div>'
      +'</div>'
      +'<div id="echarts"></div>'
      +'<div id="currunt-user">'
      +'<h2>RRManager1</h2>'
      +'<p>管理员帐号</p>'
      +'<hr>'
      +'<p>上次登录时间：2018/06/05</p>'
      +'<p>上次登录IP：10.7.92.144</p>'
      +'</div>'
      +'</div>');
    
      var x = [];
      for(let i = 0; i < 7; i++) {
        x.push(getDay(i-6));
      }
      var y = [111, 32, 768, 3, 444, 1, 33];
      
      function getDay(day){
          var today = new Date();
          var targetday_milliseconds=today.getTime() + 1000*60*60*24*day;
          today.setTime(targetday_milliseconds);
          var tYear = today.getFullYear();
          var tMonth = today.getMonth();
          var tDate = today.getDate();
          tMonth = doHandleMonth(tMonth + 1);
          tDate = doHandleMonth(tDate);
          return tYear+"-"+tMonth+"-"+tDate;
      }
      function doHandleMonth(month){
          var m = month;
          if(month.toString().length == 1){
           m = "0" + month;
          }
          return m;
      }
      

    function show() {
      console.log("systemSummaryDOM");
      $(app.config.panelContainer).html('');
      $(app.config.panelContainer).append($systemSummaryDOM);

      console.log(window.localStorage["m_manager"]);

      var myChart = echarts.init(document.getElementById('echarts'));
      
      var data = {
        id: "systemSummary"
      }
      fetch("http://localhost:8000", {
        method: "POST",
        body: JSON.stringify(data)
      }).then(function(res) {
        res.text().then(function(data) {
          console.log(JSON.parse(data));
          $("#manager-count div h1").html(JSON.parse(data).managers);
          $("#user-count div h1").html(JSON.parse(data).users);
          $("#use-count div h1").html(JSON.parse(data).use);
          $("#template-count div h1").html(JSON.parse(data).template);
          $("#currunt-user h2").html(JSON.parse(window.localStorage["m_manager"]).username);
          $("#currunt-user p:eq(1)").html("注册时间：" + JSON.parse(window.localStorage["m_manager"]).regtime);
          $("#currunt-user p:eq(2)").html("上次登录：" + JSON.parse(window.localStorage["m_manager"]).logtime);

          x = [];
          y = [];
          for(let i = 0; i < JSON.parse(data).visit.length; i++) {
            x.push(JSON.parse(data).visit[i].date);
            y.push(JSON.parse(data).visit[i].count);
          }

          var option = {
            title: {
                text: '近一周访问量',
                // subtext: "just a demo"
            },
            tooltip: {},
            legend: {
                data:['访问量']
            },
            xAxis: {
                data: x
            },
            yAxis: {},
            series: [{
                name: '访问量',
                type: 'line',
                // smooth: true,
                data: y
            }]
          };
          myChart.setOption(option);

        });
      });
    }
  
    return {show: show};
  })();
  